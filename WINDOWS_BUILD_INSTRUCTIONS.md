# Windows Build Instructions for Claude AI Assistant

## Task Overview
You are helping to create a Windows executable for a Python wind farm maintenance optimization tool. The goal is to make it easy for non-technical users to run the application without installing Python or any dependencies.

## Project Context
This is a GUI application written in Python that:
- Uses tkinter for the user interface
- Uses matplotlib for interactive visualizations
- Uses numpy for calculations
- Has two main files: `main.py` (main application) and `datamaker.py` (data generator)
- Includes a CSV data file (`nodes_data.csv`) for wind farm data
- Currently runs fine with `python main.py` when dependencies are installed

## Your Task
Create a single Windows executable (.exe) file that non-technical users can download and double-click to run, without needing Python installed.

## Required Files in Project
The project should contain these files:
- `main.py` - Main application file (contains GUI and optimization logic)
- `datamaker.py` - Data generation utility with GUI interface  
- `nodes_data.csv` - Sample wind farm data (will be generated by the app if missing)
- `README.md` - Project documentation

## Step-by-Step Instructions

### 1. Install Required Tools
```cmd
# Install Python if not already installed
# Download from python.org (Python 3.8+ recommended)

# Install PyInstaller and dependencies
pip install pyinstaller
pip install matplotlib numpy tkinter
```

### 2. Create PyInstaller Spec File
Create a file called `main.spec` with this content:

```python
# -*- mode: python ; coding: utf-8 -*-
import sys
from PyInstaller.utils.hooks import collect_data_files

block_cipher = None

# Collect matplotlib data files
matplotlib_datas = collect_data_files('matplotlib')

# Hidden imports for GUI and scientific libraries
hidden_imports = [
    'tkinter',
    'tkinter.ttk', 
    'tkinter.messagebox',
    'tkinter.simpledialog',
    'matplotlib.backends.backend_tkagg',
    'matplotlib.figure',
    'matplotlib.pyplot', 
    'matplotlib.widgets',
    'matplotlib.patches',
    'matplotlib.transforms',
    'numpy',
    'csv',
    'datetime',
    'math',
    'random',
    'functools',
    'os',
    'sys',
    'datamaker',  # Include the datamaker module
]

a = Analysis(
    ['main.py'],
    pathex=['.'],
    binaries=[],
    datas=matplotlib_datas,
    hiddenimports=hidden_imports,
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='Winfall',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    upx_exclude=[],
    runtime_tmpdir=None,
    console=False,  # No console window
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon=None,
)
```

### 3. Build the Executable
```cmd
# Navigate to project directory in Command Prompt
cd path\to\Winfall

# Build using the spec file
pyinstaller main.spec

# Alternative simple command if spec file doesn't work:
pyinstaller --onefile --windowed --name Winfall main.py
```

### 4. Test the Executable
```cmd
# The executable will be created in dist/Winfall.exe
# Test it by running:
dist\Winfall.exe
```

### 5. Verification Steps
The executable should:
- Launch without showing a console window
- Display the startup dialog asking about data sources
- Allow users to generate new data using the built-in data generator
- Display the interactive map visualization
- Work completely offline without requiring Python

### 6. Expected Results
- **File Location**: `dist/Winfall.exe`
- **File Size**: Approximately 50-150 MB (this is normal for matplotlib applications)
- **Startup Time**: 5-10 seconds on first launch
- **Functionality**: Complete standalone application

## Troubleshooting Common Issues

### If Build Fails:
1. **Missing modules**: Add any missing imports to the `hidden_imports` list in the spec file
2. **tkinter issues**: Ensure tkinter is properly installed with Python
3. **matplotlib issues**: Try installing matplotlib with `pip install matplotlib --force-reinstall`

### If Executable Crashes:
1. **Test with console**: Change `console=False` to `console=True` in spec file to see error messages
2. **Missing data files**: Ensure matplotlib data files are being collected
3. **Import errors**: Add missing modules to hidden_imports

### If File Size is Too Large:
1. **Add excludes**: Add unused packages to the `excludes` list in the spec file
2. **Use UPX**: Ensure `upx=True` for compression
3. **Check for unnecessary data files**: Review what's being included in datas

## Success Criteria
When complete, you should have:
- ✅ A single `Winfall.exe` file in the `dist/` folder
- ✅ The executable runs without requiring Python installation
- ✅ All GUI functionality works (startup dialog, data generator, map visualization)
- ✅ File size under 200MB
- ✅ No console window appears when launched

## Delivery
Please provide:
1. The working `Winfall.exe` file
2. Any build scripts or batch files you created
3. A brief summary of the build process and any issues encountered
4. Instructions for the end user on how to download and run the executable

## Additional Context
This application is a maintenance optimization tool for offshore wind farms. It helps users:
- Generate realistic wind farm data
- Visualize turbine locations on an interactive map
- Calculate optimal maintenance routes based on cost-benefit analysis
- Make data-driven decisions about which turbines need maintenance

The target users are non-technical wind farm operators who need an easy-to-use planning tool.